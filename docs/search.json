[
  {
    "objectID": "Homework4.html",
    "href": "Homework4.html",
    "title": "ST558 Homework #4",
    "section": "",
    "text": "Task 1: Conceptual Questions\n\n\nThe purpose of the lapply()function is to apply a function to every element of a list, and output a list object. The equivalent function in the purrr package is map(list_here, function_here).\n\nThe code to apply the cor() function, with a method = “kendall” option, to each element of the my_list object would be: lapply(X = my_list, FUN = cor, method = \"kendall\")\nOne advantage of using the purrr package instead of BaseR apply functions is that is never any ambiguity in what type of output you will receive, deoending on the functions you use. Whereas with sapply() for example, we may not know what the output type will be. Another advantage of the purrr package is the functions allow for inline anonymous function writing within the function calls.\nA side-effect function is a function that, when called, will produce an output but not change the data. For example, the print() or plot() functions.\nA variable inside can be named sd without any conflict from the sd function because when we call functions, R creates a temporary function environment so variables are not confused with any from the global environment. This means that if sd is called outside of the function it will call the function from the file’s current environment rather than call the sd object saved within the other function.\n\n\n\n\nTask 2: Writing R Functions\n\nlibrary(tidyverse)\nlibrary(jsonlite)\n\n\nWrite the getRMSE() function to take in 2 vectors and output the Root Mean Square Error. We need to allow for the option to be specified if we want missing values to be removed from the data before calculating.\n\n\ngetRMSE &lt;- function(responses, preds, ...){\n  sqd_diffs &lt;- (responses - preds)^2\n  RMSE &lt;- sqrt(mean(sqd_diffs, ...))\n  return(RMSE)\n}\n\n\nTest the getRMSE() function, replace 2 responses with missing values and repeat the test specifying different ways to treat the missing values.\n\n\n# Artificially generate some response  and prediction values\nset.seed(10)\nn &lt;- 100\nx &lt;- runif(n)\nresp &lt;- 3 + 10*x + rnorm(n)\npred &lt;- predict(lm(resp ~ x), data.frame(x))\n\n# Test the getRMSE() function \ngetRMSE(resp,pred)\n\n[1] 0.9581677\n\n# Replace 2 responses with missing values \nnew_resp &lt;- replace(resp,c(1,2), NA_real_)\n\n# Test the function while specifying, or not specifying, to remove missing values\ngetRMSE(new_resp, pred)\n\n[1] NA\n\n# Removing missing values and retesting\ngetRMSE(new_resp, pred, na.rm = TRUE)\n\n[1] 0.9661699\n\n\n\nWrite the getMAE() function to take in 2 vectors and output the Mean Absolute Deviation. We need to allow for the option to be specified if we want missing values to be removed from the data before calculating.\n\n\ngetMAE &lt;- function(responses, preds, ...){\n  abs_diffs &lt;- abs(responses - preds)\n  MAE &lt;- mean(abs_diffs, ...)\n  return(MAE)\n}\n\n\nTest the getMAE() function, replace 2 responses with missing values and repeat the test specifying different ways to treat the missing values.\n\n\n# Artificially generate some response  and prediction values\nset.seed(10)\nn &lt;- 100\nx &lt;- runif(n)\nresp &lt;- 3 + 10*x + rnorm(n)\npred &lt;- predict(lm(resp ~ x), data.frame(x))\n\n# Test the getRMSE() function \ngetMAE(resp,pred)\n\n[1] 0.8155776\n\n# Replace 2 responses with missing values \nnew_resp &lt;- replace(resp,c(1,2), NA_real_)\n\n# Test the function while specifying, or not specifying, to remove missing values\ngetMAE(new_resp, pred)\n\n[1] NA\n\n# Removing missing values and retesting\ngetMAE(new_resp, pred, na.rm = TRUE)\n\n[1] 0.8241201\n\n\n\nCreate a wrapper function that calls both of the function above and outputs the solution for the function(s) that is/are requested in the function call.\n\n\nwrapper_function &lt;- function(metrics = \"both\", responses, preds, ...){\n  # Use conditional logic to check the inputs are numeric vectors\n  if ((is.vector(responses)) & (is.numeric(responses)) & (is.vector(preds)) & (is.numeric(preds))) {\n    # Check the input metric chosen and output the appropriate result(s)\n    if (metrics == \"RMSE\") {\n      RMSE_result &lt;- getRMSE(responses, preds, ...)\n      return(list(\"RMSE\" = RMSE_result))\n      }\n    else if (metrics == \"MAE\") {\n      MAE_result &lt;- getMAE(responses, preds, ...)\n      return(list(\"MAE\" = MAE_result))\n      }\n    else {\n      RMSE_result &lt;- getRMSE(responses, preds, ...)\n      MAE_result &lt;- getMAE(responses, preds, ...)\n      return(list(\"RMSE\" = RMSE_result, \"MAE\" = MAE_result))\n    }\n  }\n  # For non-numeric vectors or non-vectors, print the Error message\n  else {\n   return(paste0(\"Error: One or both of the input values are not numeric vectors\"))\n  }\n}\n\n\nTest the wrapper function with different input value combinations.\n\n\n# Artificially generate some response  and prediction values\nset.seed(10)\nn &lt;- 100\nx &lt;- runif(n)\nresp &lt;- 3 + 10*x + rnorm(n)\npred &lt;- predict(lm(resp ~ x), data.frame(x))\n\n# Test function using the simulated data, calling for each metric separately then together (default)\nwrapper_function(\"RMSE\", resp, pred)\n\n$RMSE\n[1] 0.9581677\n\nwrapper_function(\"MAE\", resp, pred)\n\n$MAE\n[1] 0.8155776\n\nwrapper_function(responses = resp, preds = pred)\n\n$RMSE\n[1] 0.9581677\n\n$MAE\n[1] 0.8155776\n\n# Replace 2 of the response values with missing values and repeat\nnew_resp &lt;- replace(resp,c(1,2), NA_real_)\nwrapper_function(\"RMSE\", new_resp, pred, na.rm = T)\n\n$RMSE\n[1] 0.9661699\n\nwrapper_function(\"MAE\", new_resp, pred, na.rm = T)\n\n$MAE\n[1] 0.8241201\n\nwrapper_function(responses = new_resp, preds = pred, na.rm = T)\n\n$RMSE\n[1] 0.9661699\n\n$MAE\n[1] 0.8241201\n\n# Pass the function incorrect data (first create a data frame to pass it)\ninput_data &lt;- as.data.frame(cbind(resp,pred))\nwrapper_function(responses = input_data, preds = pred)\n\n[1] \"Error: One or both of the input values are not numeric vectors\"\n\n\n\n\nTask 3: Querying an API and Tidy-Style Function\n\nBuild the URL for finding the top Business headlines in the US.\n\n\nURL_ids &lt;- \"https://newsapi.org/v2/top-headlines?country=us&category=business&apiKey=24fdc6b4e519406abfa9722af1ed312b\"\nbus_info &lt;- httr::GET(URL_ids)\n# str(bus_info)\n\n\nParse the data and return the actual article information as a tibble.\n\n\nparsed_business_news &lt;- fromJSON(rawToChar(bus_info$content))\n# str(parsed_business_news)\nbusiness_tib &lt;- as_tibble(parsed_business_news$articles)\n\n\nWrite the query_news function to easily query this API given a subject, time period to search from, and an API key.\n\n\nquery_news &lt;- function(topic, dateFrom, key){\n  input_URL &lt;- paste0(\"https://newsapi.org/v2/everything?q=\",topic,\"&from=\",dateFrom,\"&apiKey=\",key)\n  info_from_URL &lt;- httr::GET(input_URL)\n  parsed_data &lt;- fromJSON(rawToChar(info_from_URL$content))\n  output_df &lt;- as.data.frame(parsed_data$articles)\n  return(output_df)\n}\n\n# Calling the function *head() used to limit the output\nhead(query_news(\"tesla\",\"2024-06-18\",\"24fdc6b4e519406abfa9722af1ed312b\"))\n\n         source.id      source.name         author\n1 business-insider Business Insider     Jaures Yip\n2 business-insider Business Insider     Tom Carter\n3 business-insider Business Insider    Ana Altchek\n4 business-insider Business Insider Beatrice Nolan\n5 business-insider Business Insider Theron Mohamed\n6 business-insider Business Insider  Kelsey Vlamis\n                                                                                                                title\n1                            Elon Musk's gamer streams are a new way to hear him riff on Tesla, SpaceX, and Neuralink\n2                                                              How Chinese EV makers are slowly taking over the world\n3                               New Tesla video shows an early glimpse at how Elon Musk's robotaxi service could look\n4                       Firefighters smashed a Tesla's window to rescue a toddler after the battery died, report says\n5 Elon Musk predicts universal basic income will take off once AI replaces workers. Read his 8 best quotes about UBI.\n6                                                                           China can't get enough of Elon Musk's mom\n                                                                                                                                           description\n1                              Elon Musk has been streaming video games on X while talking about future plans with Tesla, SpaceX, Neuralink, and more.\n2                                 China's Tesla rivals, like BYD, are expanding rapidly in developing markets like Brazil, Mexico, and Southeast Asia.\n3                                                   A demo video sheds more light on what Tesla is cooking up ahead of an August 8 Robotaxi unveiling.\n4   Firefighters in Scottsdale were called after a woman could not open the doors of a car containing her 20-month-old granddaughter, the report said.\n5     The Tesla and SpaceX chief predicts a \"universal high income\" as AI replaces workers, giving them more freedom in how they spend time and money.\n6 Maye Musk has become something of an influencer in China, according to a Wall Street Journal report. Meanwhile, Tesla sales are struggling in China.\n                                                                                                            url\n1                 https://www.businessinsider.com/elon-musk-gamer-streams-riff-on-tesla-spacex-neuralink-2024-6\n2                         https://www.businessinsider.com/byd-saic-chinese-ev-makers-plot-world-takeover-2024-6\n3                                  https://www.businessinsider.com/tesla-robotaxi-ride-hailing-app-video-2024-6\n4        https://www.businessinsider.com/tesla-toddler-rescued-firefighters-battery-died-doors-locked-ev-2024-6\n5 https://www.businessinsider.com/elon-musk-universal-basic-income-ubi-ai-automation-unemployment-quotes-2024-6\n6                                https://www.businessinsider.com/china-cant-get-enough-of-elon-musks-mom-2024-6\n                                                             urlToImage\n1 https://i.insider.com/66708cf6ed9a404d829e74bf?width=1200&format=jpeg\n2 https://i.insider.com/6669b825764df1611258f121?width=1200&format=jpeg\n3 https://i.insider.com/667431742efa138e0331174c?width=1200&format=jpeg\n4 https://i.insider.com/663bd696f27898f532d5350b?width=1200&format=jpeg\n5 https://i.insider.com/66758bf7886e840164beb996?width=1200&format=jpeg\n6 https://i.insider.com/66762c9365f501a8818158f6?width=1200&format=jpeg\n           publishedAt\n1 2024-06-18T09:43:02Z\n2 2024-06-22T09:22:01Z\n3 2024-06-20T17:01:27Z\n4 2024-06-20T14:40:42Z\n5 2024-06-22T12:14:01Z\n6 2024-06-22T02:35:58Z\n                                                                                                                                                                                                                    content\n1  Tesla CEO Elon Musk.Beata Zawrzel/NurPhoto via Getty Images\\r\\n&lt;ul&gt;&lt;li&gt;Fans can tune into Elon Musk's gamer livestreams on X, which can last multiple hours.&lt;/li&gt;&lt;li&gt;Musk streams under the handle cyb3rg… [+3160 chars]\n2 Chinese EV players are expanding rapidly in developing markets like Brazil, Mexico, and Southeast Asia.iStock; Rebecca Zisser/BI\\r\\n&lt;ul&gt;&lt;li&gt;China's EV upstarts appear to be plotting world domination. &lt;… [+12687 chars]\n3  The robotaxi will be unveiled on August 8.Patrick Pleul/Getty\\r\\n&lt;ul&gt;&lt;li&gt;A Tesla employee posted a video of a ride-hailing platform on LinkedIn, following previous teasers.&lt;/li&gt;&lt;li&gt;The video shows the … [+3494 chars]\n4  A Tesla Supercharger.John Keeble/Getty Images\\r\\n&lt;ul&gt;&lt;li&gt;A toddler was rescued from a locked Tesla after the car's battery died, a report says.&lt;/li&gt;&lt;li&gt;The child's grandmother called 911 after she was … [+1757 chars]\n5  Elon MuskPatrick Pleul/AFP/Getty Images\\r\\n&lt;ul&gt;&lt;li&gt;Elon Musk sees universal basic income as a necessary response to automation eliminating human jobs.&lt;/li&gt;&lt;li&gt;The Tesla chief predicts there will be \"un… [+3544 chars]\n6  Maye Musk's book \"A Woman Makes A Plan\" was a bestseller in China.Zhijian Liu/Getty Images\\r\\n&lt;ul&gt;&lt;li&gt;Maye Musk, the mother of Elon Musk, is really popular in China.&lt;/li&gt;&lt;li&gt;The model and dietician is … [+2528 chars]\n\nhead(query_news(\"south%20korea\",\"2024-06-20\",\"24fdc6b4e519406abfa9722af1ed312b\"))\n\n         source.id         source.name         author\n1 business-insider    Business Insider     Tom Porter\n2             &lt;NA&gt;            BBC News           &lt;NA&gt;\n3             &lt;NA&gt; Yahoo Entertainment KIM TONG-HYUNG\n4             &lt;NA&gt;            BBC News           &lt;NA&gt;\n5             &lt;NA&gt; Yahoo Entertainment      Greg Rasa\n6             &lt;NA&gt;            BBC News           &lt;NA&gt;\n                                                                                                        title\n1 South Korea said it might send weapons to Ukraine after Putin signed a security pact with its biggest enemy\n2                                                 North Korea building border ‘wall’, satellite images reveal\n3          North Korea says deal between Putin and Kim requires immediate military assistance in event of war\n4                                                   Human waste and old clothes in North Korea trash balloons\n5                                                    Hyundai's union in South Korea votes to authorize strike\n6                                                     Putin arrives in Vietnam in test for 'bamboo diplomacy'\n                                                                                                                                                                                                                                                              description\n1                                                                                                                                                                                  A new security pact between Russia and North Korea has alarmed US allies in east Asia.\n2                                                                                                                            North Korea is building sections of what appears to be a wall in several places near its border with South Korea, new satellite images show.\n3                                                                                                        The new agreement between Russia and North Korea reached by their leaders at a Pyongyang summit requires both countries to use all available means to provide...\n4                                                                                                                                                                   Parasites and ruined Hello Kitty clothes were found in balloons sent into South Korea from the north.\n5 Filed under:\\n UAW/Unions,Hyundai\\n Continue reading Hyundai's union in South Korea votes to authorize strike\\nHyundai's union in South Korea votes to authorize strike originally appeared on Autoblog on Mon, 24 Jun 2024 09:00:00 EDT. Please see our terms for use…\n6                                                                                                                                                                  Putin's Vietnam trip is being interpreted as displaying the support Russia still enjoys in the region.\n                                                                                                      url\n1      https://www.businessinsider.com/south-korea-could-arm-ukraine-after-russia-north-korea-pact-2024-6\n2                                                          https://www.bbc.com/news/articles/c2qq7x594vqo\n3                                 https://www.yahoo.com/news/north-korea-says-deal-between-014918001.html\n4                                                          https://www.bbc.com/news/articles/cj777rvym8eo\n5 https://consent.yahoo.com/v2/collectConsent?sessionId=1_cc-session_99a2c39e-e277-412d-bcca-669a9b55f685\n6                                                          https://www.bbc.com/news/articles/cw44z3k997do\n                                                                                                                                                              urlToImage\n1                                                                                                  https://i.insider.com/66754757423319f0c3723eed?width=1200&format=jpeg\n2                                                                     https://ichef.bbci.co.uk/news/1024/branded_news/6c2f/live/232f9d80-2f10-11ef-90be-b75b34b0bbb2.png\n3 https://s.yimg.com/ny/api/res/1.2/EkRIs0ocMV1emWevbBT4yQ--/YXBwaWQ9aGlnaGxhbmRlcjt3PTEyMDA7aD04MDA-/https://media.zenfs.com/en/ap.org/c45e80dc05b528c8e3e09834848d4c15\n4                                                                     https://ichef.bbci.co.uk/news/1024/branded_news/eef0/live/394c6b30-321b-11ef-9c8c-fb8c1c7c7566.jpg\n5                                                                                                                                                                   &lt;NA&gt;\n6                                                                     https://ichef.bbci.co.uk/news/1024/branded_news/876a/live/a4d7daf0-2eb6-11ef-a0be-f7b087b73d49.jpg\n           publishedAt\n1 2024-06-21T11:01:37Z\n2 2024-06-20T23:59:34Z\n3 2024-06-20T01:49:18Z\n4 2024-06-24T11:17:45Z\n5 2024-06-24T13:00:00Z\n6 2024-06-20T03:56:32Z\n                                                                                                                                                                                                                     content\n1   Russian President Vladimir Putin (C-L) and North Korean Supreme Leader Kim Jong Un attend a welcoming ceremony on June 19, 2024 in Pyongyang, North Korea.Contributor via Getty Images\\r\\n&lt;ul&gt;&lt;li&gt;South K… [+2785 chars]\n2 By Jake Horton, Yi Ma, Daniele Palumbo, BBC Verify\\r\\nNorth Korea is building sections of what appears to be a wall in several places near its border with South Korea, new satellite images reveal.\\r\\nIma… [+4910 chars]\n3     SEOUL, South Korea (AP) The new agreement between Russia and North Korea reached by their leaders at a Pyongyang summit requires both countries to use all available means to provide immediate militar… [+4347 chars]\n4   Parasites from human waste and defaced Hello Kitty clothing were found in bags of rubbish carried by North Korean balloons into South Korea, officials say.\\r\\nHundreds of waste-carrying balloons have b… [+2460 chars]\n5      If you click 'Accept all', we and our partners, including 237 who are part of the IAB Transparency &amp; Consent Framework, will also store and/or access information on a device (in other words, use … [+678 chars]\n6 By Jonathan Head, BBC News, South East Asia correspondent\\r\\nRussian President Vladimir Putin has arrived in the Vietnamese capital Hanoi on the second stop of an East Asian tour. \\r\\nThe trip, which com… [+4180 chars]"
  }
]